(()=>{let e,t=0,n=0;const a=document.getElementById("log"),c=document.getElementById("startButton"),o=document.getElementById("stopButton"),i=document.getElementById("downloadButton"),r=document.getElementById("clearButton"),s=document.getElementById("searchTerm"),d=document.getElementById("count");function l(e){switch(e){case 0:c.textContent="Pause Scraping",i.disabled=!0,s.disabled=!0,r.disabled=!0;break;case 1:c.textContent="Resume Scraping",i.disabled=!0,s.disabled=!0,r.disabled=!0;break;case 2:c.textContent="Start Scraping",i.disabled=!1,s.disabled=!1,r.disabled=!1}}function m(e){let t=0,n=0,a=0;t=e%60,n=(e-t)/60%60,a=(e-t-60*n)/3600;const c=`${a>9?a:"0"+a}:${n>9?n:"0"+n}:${t>9?t:"0"+t}`;document.getElementById("timer").textContent=c}chrome.runtime.connect({name:"popup"}),c.addEventListener("click",(function(){if(0===t){const c=s.value.trim();""!==c&&(t=1,chrome.runtime.sendMessage({action:"startScraping",searchTerm:c}),a.value=(new Date).toLocaleDateString("en-US")+", "+(new Date).toLocaleTimeString("en-US")+" Loaded Search Term '"+c+"'\n"+a.value,l(0),e=setInterval((()=>{n++,m(n)}),1e3))}else if(1===t){const n=s.value.trim();""!==n&&(t=2,chrome.runtime.sendMessage({action:"pauseScraping",searchTerm:n}),a.value=(new Date).toLocaleDateString("en-US")+", "+(new Date).toLocaleTimeString("en-US")+" Pause Search '"+n+"'\n"+a.value,l(1),clearInterval(e))}else if(2===t){const c=s.value.trim();""!==c&&(t=1,chrome.runtime.sendMessage({action:"resumeScraping",searchTerm:c}),a.value=(new Date).toLocaleDateString("en-US")+", "+(new Date).toLocaleTimeString("en-US")+" Resume Search '"+c+"'\n"+a.value,l(0),e=setInterval((()=>{n++,m(n)}),1e3))}})),o.addEventListener("click",(function(){t=0,chrome.runtime.sendMessage({action:"stopScraping"}),l(2),clearInterval(e)})),i.addEventListener("click",(function(){chrome.runtime.sendMessage({action:"getCSV"})})),r.addEventListener("click",(function(){chrome.runtime.sendMessage({action:"clearCSV"})})),chrome.runtime.onMessage.addListener((function(e,t,n){var c;"sendLog"===e.action?(a.value=(new Date).toLocaleDateString("en-US")+", "+(new Date).toLocaleTimeString("en-US")+" Loaded app "+e.data.name+"\n"+a.value,d.textContent=e.count):"sendCSV"===e.action?function(e,t){const n=new Blob([e],{type:"text/csv"}),a=URL.createObjectURL(n),c=document.createElement("a");c.href=a,c.download="app_data.csv",c.click()}((c=e.data,`${Object.keys(c[0]).join(",")}\n${c.map((e=>Object.values(e).join('","'))).join('"\n"').replace('"').slice(0,-1)}`)):"sendHistory"===e.action&&(d.textContent=e.data.length,s.value=e.searchTerm)}))})();